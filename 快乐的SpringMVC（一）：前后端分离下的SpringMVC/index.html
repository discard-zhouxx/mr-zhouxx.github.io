<!DOCTYPE html>


<html lang="zh-CN">


<head>
  <meta charset="utf-8" />
   
  <meta name="keywords" content="Spring,SpringBoot,Java,JVM,周某某" />
   
  <meta name="description" content="周某某的个人博客，记录Spring、Spring Boot、Java特性等知识。" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    快乐的SpringMVC（一）：前后端分离下的SpringMVC |  BloooG
  </title>
  <meta name="generator" content="hexo-theme-ayer">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
  
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

  
  

  

<link rel="alternate" href="/atom.xml" title="BloooG" type="application/atom+xml">
</head>

</html>

<body>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-快乐的SpringMVC（一）：前后端分离下的SpringMVC"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  快乐的SpringMVC（一）：前后端分离下的SpringMVC
</h1>
 

    </header>
     
    <div class="article-meta">
      <a href="/%E5%BF%AB%E4%B9%90%E7%9A%84SpringMVC%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E4%B8%8B%E7%9A%84SpringMVC/" class="article-date">
  <time datetime="2020-07-10T11:51:48.000Z" itemprop="datePublished">2020-07-10</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/SpringMVC/">SpringMVC</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> 字数统计:</span>
            <span class="post-count">5.5k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> 阅读时长≈</span>
            <span class="post-count">22 分钟</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <p><strong>INTRO：</strong> SpringMVC主要负责MVC模式的实现。SpringMVC近几年来已经逐渐取代Struts2的地位，当然现在是SpringBoot大行其道，那么为什么还要学习SpringMVC呢？因为SpringBoot是Spring的封装，而SpringMVC又是Spring的组件，所以不学习SpringMVC就无法掌握SpringBoot的web部分。</p>
<a id="more"></a>

<h2 id="MVC是什么"><a href="#MVC是什么" class="headerlink" title="MVC是什么"></a>MVC是什么</h2><p>SpringMVC中最显眼的就是MVC，那么什么是MVC呢？MVC即Model、View、Controller。是不是听上去很懵逼？如果不使用MVC会怎样？胡子眉毛一把抓，直接在JSP中写上连接数据库的代码，有些同学疑惑了PHP不就是这样的嘛？Java是一个工程上的语言，虽然Java对设计模式等可能有些滥用的情况，但是这种前后端强耦合的情况Java是绝对不允许的。于是一些大佬就推广MVC模式，大佬是这样说的：任何应用程序设计都遵循MVC模式。View：视图，给用户看的；Model：模型，不同用户需要看到的不同资源；Controller：控制器，将Model和View结合。</p>
<p>MVC最常和什么技术一起使用呢？JSP（Java Server Page），当然JSP技术终将会被淘汰，但是这里使用JSP技术讲解MVC模式会更容易理解。JSP中使用JSTL标签库来标记什么地方需要插入动态数据（也就是你数据库查出来的东西），我们呈现给客户的是带有各种标签的原生界面嘛？并不是，而是经过替换标签、渲染完成的HTML，那么JSP是怎么变成HTML的呢？在SpringMVC中有一个视图解析器，它会将JSP文件拿出来，再将Model数据捏上去，合成一个HTML加到Response体中，再返回给浏览器。</p>
<p>有些新手可能会有误解，以为Model数据和JSP一起返回到浏览器，由浏览器进行渲染界面，这是错误的。还记得我们开发JSP过程中最讨厌的事情是什么嘛？JSP不能在浏览器中打开看样式！也就是说浏览器根本不知道你JSP是个啥，浏览器只认识HTML，所以JSP转换为HTML的过程是在服务器上进行的。</p>
<p>问题来了，MVC是怎么知道哪个JSP要和哪个Model数据捏在一起的呢？这就是Controller的作用啦！我们先写一个Controller实例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmController</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    EmService emService;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EmController</span><span class="params">(EmService emService)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.emService = emService;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"getAllem"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">getAllem</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView;</span><br><span class="line">        List&lt;Em&gt; ems = emService.getAllEm;</span><br><span class="line">        <span class="comment">//注意这句</span></span><br><span class="line">        modelAndView.setViewName(<span class="string">"/WEB-INF/views/all_em.jsp"</span>);</span><br><span class="line">        <span class="comment">//注意这句</span></span><br><span class="line">        modelAndView.addProject(<span class="string">"em"</span>,ems);</span><br><span class="line">        <span class="keyword">return</span> modelAndView;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这就是一个Controller实例，从实例中看出来，我们通过Service层（严格意义上来说，Service层在MVC模式中属于Model层）获得所有的Em，将Em封装进List中，通过ModelAndView对象中的addObject()方法，告诉SpringMVC这是等会你做视图解析需要用到的Model数据，解析到哪个JSP中？setViewName方法已经告诉你了，解析到/WEB-INF/views文件夹下的all_em.jsp这个JSP文件（可以配置视图解析器前后缀，这样就不用写一大串了，只需要写JSP的文件名就行了）。</p>
<p>通过这个例子我们可以基本了解SpringMVC中的MVC到底是什么了，其实就是做完型填空，答案：数据（Model）；答题卡：界面模板（View）；试卷：这个空对应哪道题（Controller）；抄答案做填空：（视图解析器）。</p>
<p>拿到答题卡和试卷之后，我们先做试卷找到答案（通过Model层获取数据，查询数据库也好，自己胡编乱造也好。），看题号找到答题卡对应的位置（通过Controller将Model和View对应起来），填好答案（视图解析器），将填好的答题卡（HTML）交给老师（浏览器）。</p>
<h2 id="前后端分离下的MVC模式"><a href="#前后端分离下的MVC模式" class="headerlink" title="前后端分离下的MVC模式"></a>前后端分离下的MVC模式</h2><p>曾经的曾经JSP还在统治世界的时候，前后端分离也就是前端写界面，后端改成JSP。耦合度那叫一个高啊。经常后端改成JSP之后，界面崩了，鼻子不是鼻子，眼睛不是眼睛。前端还在家里睡觉呢，后端一个电话喊来加班一起改界面。于是前端说：这是我的界面？后端说：嗯呢，我稍微修改了一下。前端看着嵌入的JSTL说：啥啥啥，这都是啥？后端看着CSS和JavaScript说：啥啥啥，这又是啥？前端怒了，耦合度那么高，再干两年JDK更新都得请我去开会了。后端也怒了，再干两年我都得参与HTML6的研发了。</p>
<p>后来呢？MVC模式准备分家了，前后端对话如下：</p>
<p>前端：你别管我的界面了，你把数据给我，我自己加到界面里面。</p>
<p>后端：那我给你传个Java对象，你能用啊？</p>
<p>前端：大哥，能传个字符串不。</p>
<p>后端：我想想，那我们约定一个规范好了，专门用来前后端传输数据的。</p>
<p>前端：别了，这么麻烦呢？我这边准备用JavaScript渲染数据到界面上，你就给我传个JSON格式的字符串好了。</p>
<p>后端：那你怎么知道我返回的是失败的数据还是成功的数据呢？</p>
<p>前端：还记得HTTP嘛？HTTP有什么状态码还知道不？</p>
<p>后端：那我把数据、状态码、状态信息封装起来一起交给你吧。</p>
<p>前端：OKOK！</p>
<p>于是，前后端彻底分离了。</p>
<p>说这个是为了什么呢？就是为了告诉大家现在开发更加方便，我们将一部分的工作量分给了前端，所以目测最近几年前端所需要的人才缺口爆炸。这样一想……我准备转行去前端了，不写了，大家再见！</p>
<p>我回来了，他们要三年经验……</p>
<p>这里需要大家明白一点，虽然前后端分离大行其道，但是博主认为前后端分离是MVC模式的进化版本，MVC不会过时，过时的只是JSP这种前后端高度耦合的技术。</p>
<h3 id="SpringMVC实例"><a href="#SpringMVC实例" class="headerlink" title="SpringMVC实例"></a>SpringMVC实例</h3><p>博主使用的工具是idea，经常听大家说idea创建maven不好用，经过多个版本更新之后，idea现在除了收费应该没有什么短板了。</p>
<p>下面就跟着博主一步一步进行。</p>
<p>首先创建一个Maven项目</p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200711144026841.png" alt="image-20200711144026841"></p>
<p>给项目选一个喜欢的名字。</p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200711144305974.png" alt="image-20200711144305974"></p>
<p>选择Maven的配置文件和本地仓库。</p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200711144505757.png" alt="image-20200711144505757"></p>
<p>接下来就进入到我们的项目界面了，来看一下项目结构</p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200711155349934.png" alt="image-20200711155349934"></p>
<p>在web.xml中写上</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">web-app</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta"> <span class="meta-string">"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"</span></span></span><br><span class="line"><span class="meta"> <span class="meta-string">"http://java.sun.com/dtd/web-app_2_3.dtd"</span> &gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Archetype Created Web Application<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--Spring的ApplicationContext 载入 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 配置SpringMVC --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 指定加载外部的spring-mvc配置文件 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:spring-mvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>resources/applicationContext.xml中写上：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 使用context命名空间，自动扫描包top.vanbyz下的类，除了Controller --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"top.blooog"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> <span class="attr">expression</span>=<span class="string">"org.springframework.stereotype.Controller"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在DemoController中：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> top.blooog.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"><span class="keyword">import</span> top.blooog.service.DemoService;</span><br><span class="line"><span class="keyword">import</span> top.blooog.util.AjaxResult;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> DemoService demoService;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DemoController</span><span class="params">(DemoService demoService)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.demoService = demoService;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"hello"</span>,method = RequestMethod.GET)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AjaxResult&lt;List&gt; <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        AjaxResult&lt;List&gt; ajaxResult = <span class="keyword">new</span> AjaxResult&lt;&gt;();</span><br><span class="line">        ajaxResult.setCode((<span class="keyword">short</span>) <span class="number">200</span>);</span><br><span class="line">        ajaxResult.setData(demoService.demo());</span><br><span class="line">        ajaxResult.setMessage(<span class="string">"成功"</span>);</span><br><span class="line">        <span class="keyword">return</span> ajaxResult;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在DemoService中写：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> top.blooog.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">demo</span><span class="params">()</span></span>&#123;</span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">        list.add(<span class="string">"SpringMVC 你好！"</span>);</span><br><span class="line">        list.add(<span class="string">"欢迎来到我的个人博客"</span>);</span><br><span class="line">        list.add(<span class="string">"blooog.top"</span>);</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后配置Tomcat。</p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200711174426765.png" alt="image-20200711174426765"></p>
<p>像我这样配置，如果出现了红色提示，就点击Fix。</p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200711174451849.png" alt="image-20200711174451849"></p>
<p>看起来像是OK了，运行Tomcat。</p>
<p>浏览器弹出了这个界面：</p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200711174609270.png" alt="image-20200711174609270"></p>
<p>嘿？怎么不输出我们设置的数据呢？原来是路径问题，在@RequestMapping注解标注了访问这个Controller方法的路径，我们重新试一下：</p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200711174833487.png" alt="image-20200711174833487"></p>
<p>成功报错，也就是不认识AjaxResult这玩意，SpringMVC跟我们说：你怎么能把这玩意（AjaxResult对象）塞到响应体呢？！我干不了，你再找人吧！</p>
<p>嗯……我们给SpringMVC找一个能干这个的棒小伙吧！没错，JSON解析工具！</p>
<p>我们这里使用fastjson，这是国货之光阿里巴巴的作品，在pom文件中添加：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 阿里JSON解析器 --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;com.alibaba&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;fastjson&lt;/artifactId&gt;</span><br><span class="line">  &lt;version&gt;1.2.70&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p>此时需要告诉SpringMVC我们要用Fastjson组件，编辑spring-mvc.xml文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">&lt;!--将最后一行的&lt;mvc:annotation-driven/&gt;修改为--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">mvc:message-converters</span> <span class="attr">register-defaults</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.alibaba.fastjson.support.spring.FastJsonHttpMessageConverter"</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"supportedMediaTypes"</span> <span class="attr">value</span>=<span class="string">"application/json"</span>/&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">mvc:message-converters</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>重新访问地址localhost:8080/hello</p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200711181251731.png" alt="image-20200711181251731"></p>
<p>搞定！</p>
<p>当然，fastjson并没有我们现在用的这么简单，后期有时间的话我会出一个详细一点的教程。</p>
<h3 id="前后端开发利器——PostMan"><a href="#前后端开发利器——PostMan" class="headerlink" title="前后端开发利器——PostMan"></a>前后端开发利器——PostMan</h3><p>前面使用了浏览器进行调试（因为没有界面……），博主又不会前端这些鬼东西，没有参数的时候还好说，像HelloWorld一样字符串直接显示在浏览器上。有参数的时候呢？例如我们的登录，又怎么验证呢？难道使用浏览器那个小小小小小的调试窗口进行测试嘛？</p>
<p>接下来我介绍一个开发利器给大家PostMan，邮差！这个软件是谷歌出品，用于后端接口测试，曾经提供谷歌浏览器插件，后来独立为一个软件。</p>
<p>可以通过<a href="https://www.postman.com/" target="_blank" rel="noopener">PostMan官网</a>进行下载，博主这里简单介绍用法。</p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200711184608990.png" alt="image-20200711184608990"></p>
<p>可以看到响应模块中的body比浏览器中显示的更加清晰。</p>
<p>更多使用方法可以参考博客<a href="https://www.jianshu.com/p/97ba64888894" target="_blank" rel="noopener">Postman教程大全</a>，使用方法很简单，博主就不再啰嗦了。</p>
<h2 id="SpringMVC实例讲解"><a href="#SpringMVC实例讲解" class="headerlink" title="SpringMVC实例讲解"></a>SpringMVC实例讲解</h2><p>经过上面的实例，我们对SpringMVC也有了一些认识，首先就是我们需要进行一些配置，web.xml中配置dispatcherServlet和Mapping，这个Servlet是SpringMVC的总入口。还记得Servlet是什么嘛？往往我们一个Servlet代表一个功能，但是SpringMVC将所有请求（除了静态）都集中下来，交给dispatcherServlet，使用dispatcherServlet来执行我们的业务逻辑。dispatcherServlet具体内容的讲解我会在SpringMVC的原理中讲解。</p>
<p>我们都知道SpringMVC是Spring中的一个组件，所以我们本能的认为Spring和SpringMVC是无缝衔接的，来我们看applicationContext中的一个配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用context命名空间，自动扫描包top.vanbyz下的类，除了Controller --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"top.blooog"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> <span class="attr">expression</span>=<span class="string">"org.springframework.stereotype.Controller"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在applicationContext配置文件中，通过&lt;context:exclude-filter&gt;标签我们让Spring不要扫描controller，而在spring-mvc.xml中，我们又重新扫描Controller。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置mvc的注解扫描 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">comtext:component-scan</span> <span class="attr">base-package</span>=<span class="string">"top.blooog"</span> <span class="attr">use-default-filters</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">comtext:include-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> <span class="attr">expression</span>=<span class="string">"org.springframework.stereotype.Controller"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">comtext:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>让人疑惑，这不是脱了裤子放屁，多此一举吗？我一次性全部扫描不行吗？答案当然是否定的。因为SpringMVC和Spring是两个容器，就像电影里说的一句台词：<em>朕赐给你</em>，<em>才是你的，朕不给</em>，<em>你不能抢</em>。所以Spring容器中的Controller组件没有在SpringMVC中注册，于是就会出现找不到路径这个错误。spring-mvc.xml这个配置文件时web.xml文件钦点给dispatcherServlet的，你Spring虽然是SpringMVC的父容器，但是Spring扫描到的Controller，SpringMVC容器中并没有，也就无法使用。</p>
<p>实例中还使用了大量的注解，来看看我们使用了哪些注解……</p>
<p><strong>Controller：</strong>这个就不用多说了吧，用于扫描Controller组件的。</p>
<p><strong>RequestMapping：</strong>见名知其意，一眼就看出来是用来映射的，值得注意的是这个注解不仅可以标注在方法上，还可以标注在类上，这样这个Controller所有的方法默认前缀都加上了一个类RequestMapping值，例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"class"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"hello"</span>,method = RequestMethod.GET)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AjaxResult&lt;List&gt; <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        AjaxResult&lt;List&gt; ajaxResult = <span class="keyword">new</span> AjaxResult&lt;&gt;();</span><br><span class="line">        ajaxResult.setCode((<span class="keyword">short</span>) <span class="number">200</span>);</span><br><span class="line">        ajaxResult.setData(demoService.demo());</span><br><span class="line">        ajaxResult.setMessage(<span class="string">"成功"</span>);</span><br><span class="line">        <span class="keyword">return</span> ajaxResult;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这时，访问hello方法的url就是localhost:8080/class/hello。</p>
<p>说完value了，这个method又是什么玩意呢？这是RestFul风格的产物，简单说一下Restful风格吧：</p>
<p>RestFul风格是一种风格，而不是一种规范，就像我们左大括号写在类或者方法同一行，你可以不遵守，但是遵守了会优雅很多（大家协同工作，风格就是规范！）。这个风格要求什么呢？</p>
<ol>
<li>每一个url代表一个资源，比如user、session等等</li>
<li>使用GET、POST、PUT、DELETE4个表示操作方式的动词对服务端资源进行操作：GET用来获取资源；POST用来新建资源；PUT用来更新资源；DELETE用来删除资源；</li>
</ol>
<p>还有其他要求，希望大家自行查阅，这里不再赘述。</p>
<p>可能有的同学没有看懂，那么我再解释一下：我们的需要对A资源进行获取操作，那么我们的url就是localhost:8080/A/。而不是localhost:8080/getA/。那么有同学问了，我如果要对A资源进行增加操作呢？还使用localhost:8080/A/不就撞了吗？Restful微微一笑，少年，你学过方法的重载吗？Java方法的重载是方法同名不同参，我Restful是同链不同方法。也就是相同的url，因为浏览器发出请求的方法不同，所调用Controller中的方法也不同。</p>
<p>实例中采用的是get方法，我们通过PostMan发出get方法的请求可以接收到返回的数据，如果我们发送post请求呢？</p>
<p>在方法下拉栏里选择post然后send</p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200711211759296.png" alt="image-20200711211759296"></p>
<p>返回一长串响应体：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>HTTP Status 405 – 方法不允许<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span></span><br><span class="line"><span class="xml">	<span class="comment">&lt;!--省略--&gt;</span></span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>HTTP Status 405 – 方法不允许<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span> <span class="attr">class</span>=<span class="string">"line"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>Type<span class="tag">&lt;/<span class="name">b</span>&gt;</span> Status Report<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>消息<span class="tag">&lt;/<span class="name">b</span>&gt;</span> Request method <span class="symbol">&amp;#39;</span>POST<span class="symbol">&amp;#39;</span> not supported<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>描述<span class="tag">&lt;/<span class="name">b</span>&gt;</span> 请求行中接收的方法由源服务器知道，但目标资源不支持<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span> <span class="attr">class</span>=<span class="string">"line"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>Apache Tomcat/9.0.33<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>报了405错误，我们都知道4xx开头的都是资源找不到，因为我们没有为hello这个资源定义method=post的RequestMapping。</p>
<p>我们在Controller中加上</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"hello"</span>,method = RequestMethod.DELETE)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">delHello</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"delete!"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>随后通过PostMan的发出请求</p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200711214718197.png" alt="image-20200711214718197"></p>
<p>成功获取到想要的值。</p>
<p><strong>*注意：</strong>PostMan可以直接发送各种方法的请求，不代表浏览器也可以，HTML中的form表单仅支持get和post两种请求，需要在web.xml中添加：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这个过滤器会将下面的form表单</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form:form</span> <span class="attr">action</span>=<span class="string">"/xxx/xxx"</span> <span class="attr">method</span>=<span class="string">"put"</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">form:form</span>&gt;</span></span><br><span class="line">或者</span><br><span class="line"><span class="tag">&lt;<span class="name">form:form</span> <span class="attr">action</span>=<span class="string">"/xxx/xxx"</span> <span class="attr">method</span>=<span class="string">"delete"</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">form:form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>转换为</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"userInfo"</span> <span class="attr">action</span>=<span class="string">"/xxx/xxx"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"_method"</span> <span class="attr">value</span>=<span class="string">"put"</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span> </span><br><span class="line">或者</span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"userInfo"</span> <span class="attr">action</span>=<span class="string">"/xxx/xxx"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"_method"</span> <span class="attr">value</span>=<span class="string">"delete"</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>也就是将form表单不支持的方法，变为参数通过post传递过去。</p>
<p>因为顺便讲了Restful的关系，RequestMapping占了很大的篇幅，希望大家还没有失去耐心。再给大家一个RequestMapping的省事小技巧：</p>
<blockquote>
<p> @RequestMapping(value = “hello”,method = RequestMethod.GET) </p>
<p> 可以转变为</p>
<p> @GetMapping(“hello”)</p>
</blockquote>
<p>同理其他几个方法也可以转变为XXXMapping的格式。</p>
<p><strong>ResponseBody：</strong>这个注解可以标注在方法和类上，标注在方法上说明方法的返回值将作为HTTP的响应体返回给浏览器，同理，标注在类上就说明这个Controller类的所有方法的头上都有了一个@ResponseBody，再来一个小技巧：</p>
<blockquote>
<p>@Controller</p>
<p>@ResponseBody</p>
<p>可以简写为</p>
<p>@RestController</p>
</blockquote>
<p>这个注解没什么好说的，只要记住被标注的方法返回值会被写进HTTP响应体中，如果没有JSON解析就会报错，因为SpringMVC也不知道你返回个Java对象怎么传。</p>
<p>我们见过的所有注解都已经讲完了，下面该讲一些我们没见过的注解了。</p>
<p>怎么获取浏览器发给我们的参数呢？</p>
<p>三种办法：form表单、Ajax提交和url，form和url我们都很熟悉，Ajax就是前端的事情啦。form就不讲了，这里讲讲Ajax，虽然Ajax是前端的事情，但是作为后端开发人员，学习Ajax还是有必要的。</p>
<p>先讲一讲Ajax提交请求，Ajax将数据封装JSON字符串到HTTP请求体中，然后提交给服务器。所以我们可以使用功能强大的PostMan模仿Ajax提交请求。</p>
<p>这里涉及到一个注解<strong>@RequestBody</strong></p>
<p>在上一实例的基础上创建一个实体类entity.User</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> String age;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"User&#123;"</span> +</span><br><span class="line">                <span class="string">"userName='"</span> + userName + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", age='"</span> + age + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", password='"</span> + password + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", address='"</span> + address + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//别忘了写getter和setter方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在DemoController添加方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span>(<span class="string">"user"</span>)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> AjaxResult&lt;User&gt; <span class="title">getUser</span><span class="params">(@RequestBody User user)</span></span>&#123;</span><br><span class="line">    System.out.println(user.toString());</span><br><span class="line">    user.setAge(<span class="string">"22"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> AjaxResult&lt;User&gt;((<span class="keyword">short</span>) <span class="number">200</span>,<span class="string">"success"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>重新运行Tomcat</p>
<p>打开PostMan，设置请求体文本类型为json</p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200712002118022.png" alt="image-20200712002118022"></p>
<p>点击Body -&gt; raw </p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200712001319890.png" alt="image-20200712001319890"></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"userName"</span>:<span class="string">"zhouxx"</span>,</span><br><span class="line">    <span class="attr">"address"</span>:<span class="string">"blooog.top"</span>,</span><br><span class="line">    <span class="attr">"age"</span>:<span class="string">"21"</span>,</span><br><span class="line">    <span class="attr">"password"</span>:<span class="string">"123456"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>设置好之后点击send。</p>
<p>Idea控制台出现：</p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200712002345055.png" alt="image-20200712002345055"></p>
<p>PostMan响应界面出现</p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200712002421678.png" alt="image-20200712002421678"></p>
<p>可以看到，Ajax将数据通过JSON字符串传递过去，通过@RequestBody注解 -&gt; fastjson 转化User对象。至此服务器接收Ajax请求完成。</p>
<p>form表单提交涉及到一个注解——<strong>@RequestParam</strong>，这个注解的使用方法也特别简单，看下面的例子：</p>
<p>html/jsp的form表单：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/user/login.do"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"name"</span> <span class="attr">name</span>=<span class="string">"num"</span> <span class="attr">placeholder</span>=<span class="string">"手机号"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">placeholder</span>=<span class="string">"密码"</span>/&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"submit"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Controller：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"login.do"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">login</span><span class="params">(@RequestParam(<span class="string">"num"</span>)</span> String num,</span></span><br><span class="line"><span class="function">                   @<span class="title">RequestParam</span><span class="params">(<span class="string">"password"</span>)</span> String password,</span></span><br><span class="line"><span class="function">                   HttpSession session) </span>&#123;</span><br><span class="line">    User user = userService.login(num, password);</span><br><span class="line">    ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">    <span class="keyword">if</span> (user != <span class="keyword">null</span>) &#123;</span><br><span class="line">        session.setAttribute(<span class="string">"user"</span>, user);</span><br><span class="line">        modelAndView.setViewName(<span class="string">"success"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        modelAndView.setViewName(<span class="string">"error"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> modelAndView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>@RequestParam中的value和表单中的input中的name一致。</p>
<p>Restful风格也可以使用url传递参数，例如localhost:8080/user/1就是对id=1的user进行操作。使用<strong>@PathVariable</strong>可以实现：</p>
<p>我们在原来例子中的Controller上添加方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span>( <span class="string">"user/&#123;userName&#125;"</span>)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> AjaxResult&lt;User&gt; <span class="title">pathTest</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        @PathVariable(value = <span class="string">"userName"</span>)</span> String userName) </span>&#123;</span><br><span class="line">    System.out.println(userName);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> AjaxResult&lt;User&gt;((<span class="keyword">short</span>) <span class="number">200</span>, <span class="string">"success"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>重启Tomcat。</p>
<p>打开我们的PostMan，输入URL，把之前Body中的内容删除。</p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200712095515714.png" alt="image-20200712095515714"></p>
<p>Body上会有一个小绿点，提示里面有内容。</p>
<p>点击Send按钮发送请求。控制台显示：</p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200712095617698.png" alt="image-20200712095617698"></p>
<p>PostMan界面显示：</p>
<p><img src="https://gitee.com/vanbyz/images/raw/master/img/image-20200712095808638.png" alt="image-20200712095808638"></p>
<h2 id="注解总结"><a href="#注解总结" class="headerlink" title="注解总结"></a>注解总结</h2><p>讲到这里大家歇一歇，我来总结一下上面接触到的注解。</p>
<p>与请求接收数据相关的有：</p>
<p>@RequestBody：接收JSON请求体，用法：标注在方法头上</p>
<p>@PathVariable：接收URL上的值，用法：标注在方法参数上，如果参数是对象，那么会根据setter方法自动注入</p>
<p>@RequestParam：接收Form表单的数据，用法：标注在方法参数前面</p>
<p>与返回数据相关的有：</p>
<p>@ResponseBody：将返回值作为HTTP的响应体，用法标注在类或者方法头上。</p>
<p>@RestController：可以看作是@Controller和@ResponseBody的结合</p>
<p>与路径相关的有：</p>
<p>@RequestMapping：可以标注在类或者方法上，值为该请求 -&gt; 方法的路径，标注在类上则为这个类中所有的方法加上前缀。</p>
<p>@GetMapping：标注在方法上，值为该请求 -&gt; 方法的路径，请求的方法名为get。</p>
<p>@PostMapping：标注在方法上，值为该请求 -&gt; 方法的路径，请求的方法名为post。</p>
<p>@PutMapping：标注在方法上，值为该请求 -&gt; 方法的路径，请求的方法名为put。</p>
<p>@DeleteMapping：标注在方法上，值为该请求 -&gt; 方法的路径，请求的方法名为delete。</p>
<h2 id="搞定完结"><a href="#搞定完结" class="headerlink" title="搞定完结"></a>搞定完结</h2><p>缕一缕这篇博客讲了什么：</p>
<ol>
<li>MVC是个啥</li>
<li>前后端分离的故事</li>
<li>SpringMVC和Spring不得不说的配置</li>
<li>优雅的Restful风格</li>
<li>开发利器PostMan</li>
<li>SpringMVC注解大家庭</li>
</ol>
<p>希望你能根据这6条回忆起这篇博客的内容。</p>
<p>这篇博客对HTTP协议、Servlet有一丢丢丢的要求，如果你看起来很吃力或者有任何疑问，欢迎询问。</p>
 
      <!-- reward -->
      
      <div id="reward-btn">
        打赏
      </div>
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>版权声明： </strong>
          本博客所有文章除特别声明外，著作权归作者所有。转载请注明出处！
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://blooog.top/%E5%BF%AB%E4%B9%90%E7%9A%84SpringMVC%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E4%B8%8B%E7%9A%84SpringMVC/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SpringMVC/" rel="tag">SpringMVC</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/%E8%AE%A9%E4%BA%BA%E5%A4%B4%E7%96%BC%E7%9A%84%E5%A4%9A%E7%BA%BF%E7%A8%8B%EF%BC%9AVolatile%E5%92%8C%E7%BA%BF%E7%A8%8B%E5%8F%AF%E8%A7%81%E6%80%A7/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            让人头疼的多线程：Volatile和线程可见性
          
        </div>
      </a>
    
    
      <a href="/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9ARedis%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">Redis学习笔记（一）：Redis基础入门</div>
      </a>
    
  </nav>

   
<!-- valine评论 -->
<div id="vcomments-box">
  <div id="vcomments"></div>
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script>
<script>
  new Valine({
    el: "#vcomments",
    app_id: "cyVYcYwwMQ4bKvMVsB4BzGCr-gzGzoHsz",
    app_key: "WKskGv5QXUjcz6AM5KTqog7v",
    path: window.location.pathname,
    avatar: "monsterid",
    placeholder: "不说两句吗~",
    recordIP: true,
  });
  const infoEle = document.querySelector("#vcomments .info");
  if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
    infoEle.childNodes.forEach(function (item) {
      item.parentNode.removeChild(item);
    });
  }
</script>
<style>
  #vcomments-box {
    padding: 5px 30px;
  }

  @media screen and (max-width: 800px) {
    #vcomments-box {
      padding: 5px 0px;
    }
  }

  #vcomments-box #vcomments {
    background-color: #fff;
  }

  .v .vlist .vcard .vh {
    padding-right: 20px;
  }

  .v .vlist .vcard {
    padding-left: 10px;
  }
</style>

 
     
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2020-2021
         周某某
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></s>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="BloooG"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->


<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: 'main',
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto'
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>

<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->


<script src="/js/busuanzi-2.3.pure.min.js"></script>


<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->


<link rel="stylesheet" href="/css/clipboard.css">

<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>


<!-- CanvasBackground -->


    
    <div id="music">
    
    
    
    <iframe frameborder="no" border="1" marginwidth="0" marginheight="0" width="200" height="86"
        src="//music.163.com/outchain/player?type=2&id=1330348068&auto=0&height=66"></iframe>
</div>

<style>
    #music {
        position: fixed;
        right: 15px;
        bottom: 0;
        z-index: 998;
    }
</style>
    
  </div>
</body>

</html>